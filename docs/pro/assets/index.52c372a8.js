
/**
 * 由 One-step-admin 提供技术支持
 * https://hooray.gitee.io/one-step-admin/
 * Powered by One-step-admin
 * https://hooray.github.io/one-step-admin/
 */
    
var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o;import{_ as n}from"./index.fef54795.js";import{_ as d}from"./index.93f30b35.js";import{_ as u}from"./index.c3a964a2.js";import{_ as i}from"./index.dd537093.js";import{_ as m}from"./index.b11652ae.js";import{r as c,S as p,z as f,ap as g,T as b,o as v,k as h,A as _,x as y,$ as w,C as x,s as V,t as k,u as $,af as C,m as z,ae as U,l as P,j,Z as L,U as M}from"./vendor.b0dde714.js";import{u as S}from"./usePagination.8a5b9704.js";import{_ as O}from"./index.8d8a4cfe.js";const R=w("保密"),K=w("男"),D=w("女");var I=O({props:{id:{type:[Number,String],default:""}},setup(e,{expose:a}){const l=e,{proxy:o}=x(),t=c({loading:!1,form:{id:l.id,account:"",name:"",mobile:"",sex:"2"},rules:{account:[{required:!0,message:"请输入帐号",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:(e,a,l)=>{let r={key:"mobile",value:a};""!=t.value.form.id&&(r.id=t.value.form.id),o.$api.get("pages_example/manager/check",{baseURL:"/mock/",params:r}).then((e=>{e.data.exist?l(new Error("手机号已存在")):l()}))},trigger:"blur"}]}});return p((()=>{""!=t.value.form.id&&(t.value.loading=!0,o.$api.get("pages_example/manager/detail",{baseURL:"/mock/",params:{id:t.value.form.id}}).then((e=>{t.value.loading=!1,t.value.form.account=e.data.account,t.value.form.name=e.data.name,t.value.form.mobile=e.data.mobile})))})),a({submit(e){""==t.value.form.id?o.$refs.form.validate((a=>{a&&o.$api.post("pages_example/manager/create",t.value.form,{baseURL:"/mock/"}).then((()=>{o.$message.success({message:"模拟新增成功",center:!0}),e&&e()}))})):o.$refs.form.validate((a=>{a&&o.$api.post("pages_example/manager/edit",t.value.form,{baseURL:"/mock/"}).then((()=>{o.$message.success({message:"模拟编辑成功",center:!0}),e&&e()}))}))}}),(e,a)=>{const l=f("el-input"),o=f("el-form-item"),r=f("el-radio-button"),s=f("el-radio-group"),n=f("el-form"),d=g("loading");return b((v(),h("div",null,[_(n,{ref:"form",model:t.value.form,rules:t.value.rules,"label-width":"120px","label-suffix":"："},{default:y((()=>[_(o,{label:"帐号",prop:"account"},{default:y((()=>[_(l,{modelValue:t.value.form.account,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.form.account=e),placeholder:"请输入帐号"},null,8,["modelValue"])])),_:1}),_(o,{label:"姓名",prop:"name"},{default:y((()=>[_(l,{modelValue:t.value.form.name,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value.form.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])])),_:1}),_(o,{label:"手机号",prop:"mobile"},{default:y((()=>[_(l,{modelValue:t.value.form.mobile,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.form.mobile=e),placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),_(o,{label:"性别",prop:"sex"},{default:y((()=>[_(s,{modelValue:t.value.form.sex,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.form.sex=e),size:"small"},{default:y((()=>[_(r,{label:"2"},{default:y((()=>[R])),_:1}),_(r,{label:"1"},{default:y((()=>[K])),_:1}),_(r,{label:"0"},{default:y((()=>[D])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),[[d,t.value.loading]])}}},[["__scopeId","data-v-aa80d99c"]]);const q=w("取 消"),A=w("确 定"),E={class:"buttons"},N=w("取 消"),T=w("确 定"),B={props:(Z=((e,a)=>{for(var l in a||(a={}))t.call(a,l)&&s(e,l,a[l]);if(o)for(var l of o(a))r.call(a,l)&&s(e,l,a[l]);return e})({},I.props),F={modelValue:{type:Boolean,default:!1},mode:{type:String,default:"dialog",validator:e=>["dialog","drawer"].includes(e)}},a(Z,l(F))),emits:["update:modelValue","success"],setup(e,{emit:a}){const l=e,{proxy:o}=x();let t=V({get:function(){return l.modelValue},set:function(e){a("update:modelValue",e)}});const r=V((()=>""==l.id?"新增管理员":"编辑管理员"));function s(){o.$refs.form.submit((()=>{a("success"),n()}))}function n(){t.value=!1}return(e,a)=>{const o=f("el-button"),d=f("el-dialog"),u=f("el-drawer");return v(),h("div",null,["dialog"===l.mode?(v(),k(d,{key:0,modelValue:$(t),"onUpdate:modelValue":a[0]||(a[0]=e=>C(t)?t.value=e:t=e),title:$(r),width:"600px","close-on-click-modal":!1,"append-to-body":"","destroy-on-close":""},{footer:y((()=>[_(o,{size:"large",onClick:n},{default:y((()=>[q])),_:1}),_(o,{type:"primary",size:"large",onClick:s},{default:y((()=>[A])),_:1})])),default:y((()=>[_(I,U({ref:"form"},e.$props),null,16)])),_:1},8,["modelValue","title"])):"drawer"===l.mode?(v(),k(u,{key:1,modelValue:$(t),"onUpdate:modelValue":a[1]||(a[1]=e=>C(t)?t.value=e:t=e),title:$(r),size:"600px","close-on-click-modal":!1,"custom-class":"form-mode-drawer","destroy-on-close":""},{default:y((()=>[_(I,U({ref:"form"},e.$props,{class:"form-container"}),null,16),P("div",E,[_(o,{size:"large",onClick:n},{default:y((()=>[N])),_:1}),_(o,{type:"primary",size:"large",onClick:s},{default:y((()=>[T])),_:1})])])),_:1},8,["modelValue","title"])):z("v-if",!0)])}}};var Z,F,G=O(B,[["__scopeId","data-v-240f849c"]]);const H=w("新增管理员"),J=w("全部"),Q=w("男"),W=w("女"),X=w("保密"),Y=w("筛 选"),ee=w("批量操作"),ae=w("男"),le=w("女"),oe=w("保密"),te=w("编辑"),re=w(" 更多操作 "),se=w("重置密码"),ne=w("删除"),de=j({name:"PagesExampleManagerList"});var ue=O(Object.assign(de,{setup(e){const{pagination:a,getParams:l,onSizeChange:o,onCurrentChange:t,onSortChange:r}=S(),{proxy:s}=x(),w=c({loading:!1,formMode:"dialog",formModeProps:{visible:!1,id:""},search:{account:"",name:"",mobile:"",sex:""},searchMore:!1,batch:{enable:!0,selectionDataList:[]},dataList:[]});function V(){w.value.loading=!0;let e=l();w.value.search.account&&(e.account=w.value.search.account),w.value.search.name&&(e.name=w.value.search.name),w.value.search.mobile&&(e.mobile=w.value.search.mobile),""!=w.value.search.sex&&(e.sex=w.value.search.sex),s.$api.get("pages_example/manager/list",{baseURL:"/mock/",params:e}).then((e=>{w.value.loading=!1,w.value.dataList=e.data.list,a.value.total=e.data.total}))}function C(e){o(e).then((()=>V()))}function U(e){t(e).then((()=>V()))}function P(e,a){r(e,a).then((()=>V()))}function j(){w.value.formModeProps.id="",w.value.formModeProps.visible=!0}function O(e,a){switch(e){case"resetPassword":!function(e){s.$confirm(`确认将「${e.account}」的密码重置为 “123456” 吗？`,"确认信息").then((()=>{s.$api.post("pages_example/manager/password/reset",{id:e.id},{baseURL:"/mock/"}).then((()=>{s.$message.success({message:"模拟重置成功",center:!0})}))})).catch((()=>{}))}(a);break;case"delete":!function(e){s.$confirm(`确认删除「${e.account}」管理员吗？`,"确认信息").then((()=>{s.$api.post("pages_example/manager/delete",{id:e.id},{baseURL:"/mock/"}).then((()=>{V(),s.$message.success({message:"模拟删除成功",center:!0})}))})).catch((()=>{}))}(a)}}return p((()=>{V()})),(e,l)=>{const o=m,t=f("el-button"),r=f("el-input"),c=f("el-form-item"),p=f("el-col"),x=f("el-row"),S=f("el-radio-button"),R=f("el-radio-group"),K=f("el-form"),D=i,I=u,q=f("el-table-column"),A=f("el-tag"),E=f("el-switch"),N=d,T=f("el-dropdown-item"),B=f("el-dropdown-menu"),Z=f("el-dropdown"),F=f("el-table"),de=f("el-pagination"),ue=n,ie=g("loading");return v(),h("div",null,[_(o,{title:"管理员管理",content:"页面数据为 Mock 示例数据，非真实数据。"}),_(ue,null,{default:y((()=>[_(t,{type:"primary",size:"large",icon:"el-icon-plus",onClick:j},{default:y((()=>[H])),_:1}),_(D,{"show-more":"",onToggle:l[4]||(l[4]=e=>w.value.searchMore=e)},{default:y((()=>[_(K,{model:w.value.search,size:"default","label-width":"100px","label-suffix":"："},{default:y((()=>[_(x,null,{default:y((()=>[_(p,{md:8},{default:y((()=>[_(c,{label:"帐号"},{default:y((()=>[_(r,{modelValue:w.value.search.account,"onUpdate:modelValue":l[0]||(l[0]=e=>w.value.search.account=e),placeholder:"请输入帐号，支持模糊查询",clearable:"",onKeydown:L(V,["enter"]),onClear:V},null,8,["modelValue","onKeydown"])])),_:1})])),_:1}),_(p,{md:8},{default:y((()=>[_(c,{label:"姓名"},{default:y((()=>[_(r,{modelValue:w.value.search.name,"onUpdate:modelValue":l[1]||(l[1]=e=>w.value.search.name=e),placeholder:"请输入姓名，支持模糊查询",clearable:"",onKeydown:L(V,["enter"]),onClear:V},null,8,["modelValue","onKeydown"])])),_:1})])),_:1}),_(p,{md:8},{default:y((()=>[_(c,{label:"手机号"},{default:y((()=>[_(r,{modelValue:w.value.search.mobile,"onUpdate:modelValue":l[2]||(l[2]=e=>w.value.search.mobile=e),placeholder:"请输入手机号",clearable:"",onKeydown:L(V,["enter"]),onClear:V},null,8,["modelValue","onKeydown"])])),_:1})])),_:1})])),_:1}),b(_(x,null,{default:y((()=>[_(p,{md:8},{default:y((()=>[_(c,{label:"性别"},{default:y((()=>[_(R,{modelValue:w.value.search.sex,"onUpdate:modelValue":l[3]||(l[3]=e=>w.value.search.sex=e),onChange:V},{default:y((()=>[_(S,{label:""},{default:y((()=>[J])),_:1}),_(S,{label:"1"},{default:y((()=>[Q])),_:1}),_(S,{label:"0"},{default:y((()=>[W])),_:1}),_(S,{label:"2"},{default:y((()=>[X])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},512),[[M,w.value.searchMore]]),_(c,null,{default:y((()=>[_(t,{type:"primary",icon:"el-icon-search",onClick:V},{default:y((()=>[Y])),_:1})])),_:1})])),_:1},8,["model"])])),_:1}),w.value.batch.enable?(v(),k(I,{key:0,data:w.value.dataList,"selection-data":w.value.batch.selectionDataList,onCheckAll:l[5]||(l[5]=a=>e.$refs.table.toggleAllSelection()),onCheckNull:l[6]||(l[6]=a=>e.$refs.table.clearSelection())},{default:y((()=>[_(t,{size:"default"},{default:y((()=>[ee])),_:1})])),_:1},8,["data","selection-data"])):z("v-if",!0),b((v(),k(F,{ref:"table",class:"list-table",data:w.value.dataList,border:"",stripe:"","highlight-current-row":"",onSortChange:P,onSelectionChange:l[7]||(l[7]=e=>w.value.batch.selectionDataList=e)},{default:y((()=>[w.value.batch.enable?(v(),k(q,{key:0,type:"selection",align:"center",fixed:""})):z("v-if",!0),_(q,{prop:"account",sortable:"",label:"帐号"}),_(q,{prop:"name",label:"姓名",width:"100",align:"center"}),_(q,{prop:"sex",label:"性别",width:"100",align:"center"},{default:y((e=>[1==e.row.sex?(v(),k(A,{key:0,type:"success",size:"small"},{default:y((()=>[ae])),_:1})):0==e.row.sex?(v(),k(A,{key:1,type:"warning",size:"small"},{default:y((()=>[le])),_:1})):(v(),k(A,{key:2,type:"info",size:"small"},{default:y((()=>[oe])),_:1}))])),_:1}),_(q,{prop:"mobile",label:"手机号",width:"150",align:"center"}),_(q,{label:"状态",width:"100",align:"center"},{default:y((e=>[_(E,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,onChange:a=>{return l=a,o=e.row,void s.$confirm(`确认${l?"启用":"停用"}「${o.account}」吗？`,"确认信息").then((()=>{s.$api.post("pages_example/manager/change/status",{id:o.id,status:l},{baseURL:"/mock/"}).then((()=>{s.$message.success({message:`模拟${l?"启用":"停用"}成功`,center:!0})}))})).catch((()=>{o.status=!l}));var l,o}},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),_(q,{label:"操作",width:"200",align:"center",fixed:"right"},{default:y((e=>[_(t,{type:"primary",size:"small",plain:"",onClick:a=>{return l=e.row,w.value.formModeProps.id=l.id,void(w.value.formModeProps.visible=!0);var l}},{default:y((()=>[te])),_:2},1032,["onClick"]),_(Z,{onCommand:a=>O(a,e.row)},{dropdown:y((()=>[_(B,null,{default:y((()=>[_(T,{command:"resetPassword"},{default:y((()=>[se])),_:1}),_(T,{command:"delete",divided:""},{default:y((()=>[ne])),_:1})])),_:1})])),default:y((()=>[_(t,{size:"small"},{default:y((()=>[re,_(N,{name:"el-icon-arrow-down"})])),_:1})])),_:2},1032,["onCommand"])])),_:1})])),_:1},8,["data"])),[[ie,w.value.loading]]),_(de,{"current-page":$(a).page,total:$(a).total,"page-size":$(a).size,"page-sizes":$(a).sizes,layout:$(a).layout,"hide-on-single-page":!1,class:"pagination",background:"",onCurrentChange:U,onSizeChange:C},null,8,["current-page","total","page-size","page-sizes","layout"])])),_:1}),["dialog","drawer"].includes(w.value.formMode)?(v(),k(G,{key:0,id:w.value.formModeProps.id,modelValue:w.value.formModeProps.visible,"onUpdate:modelValue":l[8]||(l[8]=e=>w.value.formModeProps.visible=e),mode:w.value.formMode,onSuccess:V},null,8,["id","modelValue","mode"])):z("v-if",!0)])}}}),[["__scopeId","data-v-65f2f370"]]);export{ue as default};

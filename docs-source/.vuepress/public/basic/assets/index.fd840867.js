
/**
 * 由 One-step-admin 提供技术支持
 * Powered by One-step-admin
 * https://one-step-admin.netlify.app
 * 代码仓库
 * Gitee  https://gitee.com/hooray/one-step-admin
 * Github https://github.com/hooray/one-step-admin
 */
    
import{b as e,i as t,h as a,c as i,e as s,g as l,j as n,p as r,k as o,x as p,E as d,s as c,r as u,a2 as m,aQ as h,H as f,w as g,v as x,F as y}from"./index.eaca9d64.js";import{E as v,a as b,_ as w}from"./index.81c0fb87.js";import{E as j}from"./el-alert.14161a0c.js";/* empty css                */import{_}from"./index.8eb858d1.js";import{_ as k}from"./plugin-vue_export-helper.21dcd24c.js";import{E as $,a as S}from"./el-image.c34a297a.js";import{_ as z}from"./index.9a39b5db.js";import{_ as O}from"./index.34688040.js";import"./check.fdf129df.js";import"./error2.8f448c70.js";import"./isNil.aac33454.js";import"./typescript2.50fc0493.js";import"./index2.a801f47d.js";import"./index2.fa9449b9.js";import"./arrow-left.14a2580d.js";import"./arrow-right.7abf62bd.js";import"./debounce.ac625793.js";import"./index2.8e851031.js";import"./scroll2.f3eaa5fd.js";const I={class:"slot"},C=(e=>(r("data-v-507d0a7c"),e=e(),o(),e))((()=>s("div",{class:"el-upload__text"},[c("将文件拖到此处，或"),s("em",null,"点击上传")],-1))),V={key:0,class:"el-upload__tip"},E={style:{display:"inline-block"}};var N=k({name:"index",props:{action:{type:String,required:!0},headers:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},name:{type:String,default:"file"},size:{type:Number,default:2},max:{type:Number,default:3},files:{type:Array,default:()=>[]},notip:{type:Boolean,default:!1},ext:{type:Array,default:()=>["zip","rar"]}},emits:["on-success"],setup(r,{emit:o}){const c=r;function u(e){const t=e.name.split("."),a=t[t.length-1],i=c.ext.indexOf(a)>=0,s=e.size/1024/1024<c.size;return i||p.error(`上传文件只支持 ${c.ext.join(" / ")} 格式！`),s||p.error(`上传文件大小不能超过 ${c.size}MB！`),i&&s}function m(){p.warning("文件上传超过限制")}function h(e,t){o("on-success",e,t)}return(o,p)=>{const c=_,f=d,g=j,x=v;return e(),t(x,{action:r.action,data:r.data,name:r.name,"before-upload":u,"on-exceed":m,"on-success":h,"file-list":r.files,limit:r.max,drag:""},{tip:a((()=>[r.notip?n("v-if",!0):(e(),i("div",V,[s("div",E,[l(g,{title:`上传文件支持 ${r.ext.join(" / ")} 格式，单个文件大小不超过 ${r.size}MB，且文件数量不超过 ${r.max} 个`,type:"info","show-icon":"",closable:!1},null,8,["title"])])]))])),default:a((()=>[s("div",I,[l(f,{class:"el-icon--upload"},{default:a((()=>[l(c,{name:"ep:upload-filled"})])),_:1}),C])])),_:1},8,["action","data","name","file-list","limit"])}}},[["__scopeId","data-v-507d0a7c"]]);const U={class:"upload-container"},B={class:"mask"},M={class:"actions"},A=["onClick"],T=["onClick"],K=["onClick"],q=["onClick"],F={key:0,class:"el-upload__tip"},L={style:{display:"inline-block"}};var R=k({name:"index",props:{action:{type:String,required:!0},headers:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}},name:{type:String,default:"file"},url:{type:Array,default:()=>[]},max:{type:Number,default:3},size:{type:Number,default:2},width:{type:Number,default:150},height:{type:Number,default:150},placeholder:{type:String,default:""},notip:{type:Boolean,default:!1},ext:{type:Array,default:()=>["jpg","png","gif","bmp"]}},emits:["update:url","on-success"],setup(r,{emit:o}){const c=r,w=u({dialogImageIndex:0,imageViewerVisible:!1,progress:{preview:"",percent:0}});function k(){w.value.imageViewerVisible=!1}function z(e,t){let a=c.url;"left"==t&&0!=e&&(a[e]=a.splice(e-1,1,a[e])[0]),"right"==t&&e!=a.length-1&&(a[e]=a.splice(e+1,1,a[e])[0]),o("update:url",a)}function O(e){const t=e.name.split("."),a=t[t.length-1],i=c.ext.indexOf(a)>=0,s=e.size/1024/1024<c.size;return i||p.error(`上传图片只支持 ${c.ext.join(" / ")} 格式！`),s||p.error(`上传图片大小不能超过 ${c.size}MB！`),i&&s&&(w.value.progress.preview=URL.createObjectURL(e)),i&&s}function I(e){w.value.progress.percent=~~e.percent}function C(e){w.value.progress.preview="",w.value.progress.percent=0,o("on-success",e)}return(p,u)=>{const V=$,E=_,N=d,R=b,H=v,Q=j,D=S;return e(),i("div",U,[(e(!0),i(m,null,h(r.url,((p,d)=>(e(),i("div",{key:d,class:"images"},[d<r.max?(e(),t(V,{key:0,src:p,style:f(`width:${r.width}px;height:${r.height}px;`),fit:"cover"},null,8,["src","style"])):n("v-if",!0),s("div",B,[s("div",M,[s("span",{title:"预览",onClick:e=>function(e){w.value.dialogImageIndex=e,w.value.imageViewerVisible=!0}(d)},[l(N,null,{default:a((()=>[l(E,{name:"ep:zoom-in"})])),_:1})],8,A),s("span",{title:"移除",onClick:e=>function(e){let t=c.url;t.splice(e,1),o("update:url",t)}(d)},[l(N,null,{default:a((()=>[l(E,{name:"ep:delete"})])),_:1})],8,T),g(s("span",{title:"左移",class:y({disabled:0==d}),onClick:e=>z(d,"left")},[l(N,null,{default:a((()=>[l(E,{name:"ep:back"})])),_:1})],10,K),[[x,r.url.length>1]]),g(s("span",{title:"右移",class:y({disabled:d==r.url.length-1}),onClick:e=>z(d,"right")},[l(N,null,{default:a((()=>[l(E,{name:"ep:right"})])),_:1})],10,q),[[x,r.url.length>1]])])])])))),128)),g(l(H,{"show-file-list":!1,headers:r.headers,action:r.action,data:r.data,name:r.name,"before-upload":O,"on-progress":I,"on-success":C,drag:"",class:"images-upload"},{default:a((()=>[s("div",{class:"image-slot",style:f(`width:${r.width}px;height:${r.height}px;`)},[l(N,null,{default:a((()=>[l(E,{name:"ep:plus"})])),_:1})],4),g(s("div",{class:"progress",style:f(`width:${r.width}px;height:${r.height}px;`)},[l(V,{src:w.value.progress.preview,style:f(`width:${r.width}px;height:${r.height}px;`),fit:"fill"},null,8,["src","style"]),l(R,{type:"circle",width:.8*Math.min(r.width,r.height),percentage:w.value.progress.percent},null,8,["width","percentage"])],4),[[x,w.value.progress.percent]])])),_:1},8,["headers","action","data","name"]),[[x,r.url.length<r.max]]),r.notip?n("v-if",!0):(e(),i("div",F,[s("div",L,[l(Q,{title:`上传图片支持 ${r.ext.join(" / ")} 格式，单张图片大小不超过 ${r.size}MB，建议图片尺寸为 ${r.width}*${r.height}，且图片数量不超过 ${r.max} 张`,type:"info","show-icon":"",closable:!1},null,8,["title"])])])),w.value.imageViewerVisible?(e(),t(D,{key:1,"url-list":r.url,"initial-index":w.value.dialogImageIndex,onClose:k},null,8,["url-list","initial-index"])):n("v-if",!0)])}}},[["__scopeId","data-v-3cb953a2"]]);var H=k({data:()=>({image:"",images:[],files:[{name:"测试文件.zip",url:"http://images.lookbi.com/uploads/apply/96/d8521fc691e472eec91a170201866e7d.zip"}]}),mounted(){this.image="https://picsum.photos/400",this.images=["https://picsum.photos/400","https://picsum.photos/600","https://picsum.photos/500"]},methods:{handleSuccess1(e){""==e.error?this.image=e.data.path:this.$message.warning(e.error)},handleSuccess2(e){""==e.error?this.images.push(e.data.path):this.$message.warning(e.error)},handleSuccess3(e,t){this.files.push({name:t.name,url:""==e.error?e.data.path:""}),this.$nextTick((()=>{""!=e.error&&(this.$message.warning(e.error),this.files.pop())}))}}},[["render",function(t,s,n,r,o,p){const d=O,c=w,u=z,m=R,h=N;return e(),i("div",null,[l(d,{title:"上传",content:"ImageUpload / ImagesUpload / FileUpload"}),l(u,{title:"单图上传"},{default:a((()=>[l(c,{url:o.image,"onUpdate:url":s[0]||(s[0]=e=>o.image=e),action:"http://scrm.1daas.com/api/upload/upload",name:"image",width:250,height:150,data:{token:"TKE615916022101558"},onOnSuccess:p.handleSuccess1},null,8,["url","onOnSuccess"])])),_:1}),l(u,{title:"多图上传（默认最多3张）"},{default:a((()=>[l(m,{url:o.images,"onUpdate:url":s[1]||(s[1]=e=>o.images=e),action:"http://scrm.1daas.com/api/upload/upload",name:"image",data:{token:"TKE615916022101558"},onOnSuccess:p.handleSuccess2},null,8,["url","onOnSuccess"])])),_:1}),l(u,{title:"文件上传（默认最多3个）"},{default:a((()=>[l(h,{files:o.files,action:"http://scrm.1daas.com/api/upload/upload",name:"image",data:{token:"TKE615916022101558"},onOnSuccess:p.handleSuccess3},null,8,["files","onOnSuccess"])])),_:1})])}]]);export{H as default};
